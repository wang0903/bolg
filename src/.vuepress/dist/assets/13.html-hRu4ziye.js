const a=JSON.parse('{"key":"v-12b4a76a","path":"/demo/java%E6%96%87%E7%AB%A0/13.html","title":"解决EasyExce的LocalTime、LocalDate和Timestamp转换器","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2025-03-13T00:00:00.000Z","category":["java"],"tag":["LocalTime","EasyExce"],"star":true,"sticky":true,"description":"解决EasyExce的LocalTime、LocalDate和Timestamp转换器 1、创建一个公共转换类DateTimeConverter import com.alibaba.excel.converters.Converter; import com.alibaba.excel.metadata.GlobalConfiguration; import com.alibaba.excel.metadata.property.ExcelContentProperty; import com.alibaba.excel.write.metadata.holder.WriteCellData; import java.time.LocalDate; import java.time.LocalTime; import java.time.format.DateTimeFormatter; public class DateTimeConverter implements Converter&lt;Object&gt; { private final DateTimeFormatter formatter; // 构造器接收不同的格式化器 public DateTimeConverter(DateTimeFormatter formatter) { this.formatter = formatter; } @Override public Class&lt;?&gt; supportJavaTypeKey() { return Object.class; } @Override public WriteCellData&lt;?&gt; convertToExcelData(Object value, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration) { if (value == null) { return new WriteCellData&lt;&gt;(\\"\\"); } return new WriteCellData&lt;&gt;(formatter.format((java.time.temporal.Temporal) value)); // 使用 formatter 格式化日期/时间 } }","head":[["meta",{"property":"og:url","content":"https://github.com/demo/java%E6%96%87%E7%AB%A0/13.html"}],["meta",{"property":"og:title","content":"解决EasyExce的LocalTime、LocalDate和Timestamp转换器"}],["meta",{"property":"og:description","content":"解决EasyExce的LocalTime、LocalDate和Timestamp转换器 1、创建一个公共转换类DateTimeConverter import com.alibaba.excel.converters.Converter; import com.alibaba.excel.metadata.GlobalConfiguration; import com.alibaba.excel.metadata.property.ExcelContentProperty; import com.alibaba.excel.write.metadata.holder.WriteCellData; import java.time.LocalDate; import java.time.LocalTime; import java.time.format.DateTimeFormatter; public class DateTimeConverter implements Converter&lt;Object&gt; { private final DateTimeFormatter formatter; // 构造器接收不同的格式化器 public DateTimeConverter(DateTimeFormatter formatter) { this.formatter = formatter; } @Override public Class&lt;?&gt; supportJavaTypeKey() { return Object.class; } @Override public WriteCellData&lt;?&gt; convertToExcelData(Object value, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration) { if (value == null) { return new WriteCellData&lt;&gt;(\\"\\"); } return new WriteCellData&lt;&gt;(formatter.format((java.time.temporal.Temporal) value)); // 使用 formatter 格式化日期/时间 } }"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-13T05:31:45.000Z"}],["meta",{"property":"article:author","content":"小辣椒"}],["meta",{"property":"article:tag","content":"LocalTime"}],["meta",{"property":"article:tag","content":"EasyExce"}],["meta",{"property":"article:published_time","content":"2025-03-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-03-13T05:31:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"解决EasyExce的LocalTime、LocalDate和Timestamp转换器\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-03-13T00:00:00.000Z\\",\\"dateModified\\":\\"2025-03-13T05:31:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"小辣椒\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"1、创建一个公共转换类DateTimeConverter","slug":"_1、创建一个公共转换类datetimeconverter","link":"#_1、创建一个公共转换类datetimeconverter","children":[]},{"level":2,"title":"2、创建传递LocalDate类型的类LocalDateConverter","slug":"_2、创建传递localdate类型的类localdateconverter","link":"#_2、创建传递localdate类型的类localdateconverter","children":[]},{"level":2,"title":"3、创建传递LocalTime类型的类LocalTimeConverter","slug":"_3、创建传递localtime类型的类localtimeconverter","link":"#_3、创建传递localtime类型的类localtimeconverter","children":[]},{"level":2,"title":"4、创建传递Timestamp类型的类TimestampConverter","slug":"_4、创建传递timestamp类型的类timestampconverter","link":"#_4、创建传递timestamp类型的类timestampconverter","children":[]}],"git":{"createdTime":1741843905000,"updatedTime":1741843905000,"contributors":[{"name":"wangbinggui","email":"1819493621@qq.com","commits":1}]},"readingTime":{"minutes":1.17,"words":352},"filePathRelative":"demo/java文章/13.md","localizedDate":"2025年3月13日","excerpt":"<h1> 解决EasyExce的LocalTime、LocalDate和Timestamp转换器</h1>\\n<h2> 1、创建一个公共转换类DateTimeConverter</h2>\\n<div class=\\"language-java line-numbers-mode\\" data-ext=\\"java\\"><pre class=\\"language-java\\"><code><span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">com<span class=\\"token punctuation\\">.</span>alibaba<span class=\\"token punctuation\\">.</span>excel<span class=\\"token punctuation\\">.</span>converters<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">Converter</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">com<span class=\\"token punctuation\\">.</span>alibaba<span class=\\"token punctuation\\">.</span>excel<span class=\\"token punctuation\\">.</span>metadata<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">GlobalConfiguration</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">com<span class=\\"token punctuation\\">.</span>alibaba<span class=\\"token punctuation\\">.</span>excel<span class=\\"token punctuation\\">.</span>metadata<span class=\\"token punctuation\\">.</span>property<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">ExcelContentProperty</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">com<span class=\\"token punctuation\\">.</span>alibaba<span class=\\"token punctuation\\">.</span>excel<span class=\\"token punctuation\\">.</span>write<span class=\\"token punctuation\\">.</span>metadata<span class=\\"token punctuation\\">.</span>holder<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">WriteCellData</span></span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">java<span class=\\"token punctuation\\">.</span>time<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">LocalDate</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">java<span class=\\"token punctuation\\">.</span>time<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">LocalTime</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">import</span> <span class=\\"token import\\"><span class=\\"token namespace\\">java<span class=\\"token punctuation\\">.</span>time<span class=\\"token punctuation\\">.</span>format<span class=\\"token punctuation\\">.</span></span><span class=\\"token class-name\\">DateTimeFormatter</span></span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token keyword\\">public</span> <span class=\\"token keyword\\">class</span> <span class=\\"token class-name\\">DateTimeConverter</span> <span class=\\"token keyword\\">implements</span> <span class=\\"token class-name\\">Converter</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">Object</span><span class=\\"token punctuation\\">&gt;</span></span> <span class=\\"token punctuation\\">{</span>\\n\\n    <span class=\\"token keyword\\">private</span> <span class=\\"token keyword\\">final</span> <span class=\\"token class-name\\">DateTimeFormatter</span> formatter<span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\">// 构造器接收不同的格式化器</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token class-name\\">DateTimeConverter</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">DateTimeFormatter</span> formatter<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token keyword\\">this</span><span class=\\"token punctuation\\">.</span>formatter <span class=\\"token operator\\">=</span> formatter<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n\\n    <span class=\\"token annotation punctuation\\">@Override</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token class-name\\">Class</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token operator\\">?</span><span class=\\"token punctuation\\">&gt;</span></span> <span class=\\"token function\\">supportJavaTypeKey</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token keyword\\">return</span> <span class=\\"token class-name\\">Object</span><span class=\\"token punctuation\\">.</span><span class=\\"token keyword\\">class</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n\\n    <span class=\\"token annotation punctuation\\">@Override</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token class-name\\">WriteCellData</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token operator\\">?</span><span class=\\"token punctuation\\">&gt;</span></span> <span class=\\"token function\\">convertToExcelData</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Object</span> value<span class=\\"token punctuation\\">,</span> <span class=\\"token class-name\\">ExcelContentProperty</span> contentProperty<span class=\\"token punctuation\\">,</span> <span class=\\"token class-name\\">GlobalConfiguration</span> globalConfiguration<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>value <span class=\\"token operator\\">==</span> <span class=\\"token keyword\\">null</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n            <span class=\\"token keyword\\">return</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">WriteCellData</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token punctuation\\">}</span>\\n        <span class=\\"token keyword\\">return</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">WriteCellData</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span>formatter<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">format</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\"><span class=\\"token namespace\\">java<span class=\\"token punctuation\\">.</span>time<span class=\\"token punctuation\\">.</span>temporal<span class=\\"token punctuation\\">.</span></span>Temporal</span><span class=\\"token punctuation\\">)</span> value<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span> <span class=\\"token comment\\">// 使用 formatter 格式化日期/时间</span>\\n    <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{a as data};
